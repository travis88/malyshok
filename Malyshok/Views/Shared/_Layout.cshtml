@model PageViewModel
@{
    ViewBag.Version = "1.0.1";
    string currentYear = DateTime.Now.Year.ToString();
    string theme = Model.SitesInfo.Theme + ".css";

    var mainMenu = (Model.SiteMapArray != null) ?
                    Model.SiteMapArray
                              .Where(w => w.MenuAlias.Equals("main"))
                              .OrderBy(o => o.MenuSort)
                              .Select(s => new
                              {
                                  Path = s.Path,
                                  Alias = s.Alias,
                                  Title = s.Title,
                                  FrontSection = s.FrontSection,
                                  Url = s.Url
                              }).ToArray()
                      : null;

}

<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="@ViewBag.keywords">
    <meta name="description" content="@ViewBag.description">
    <title> @ViewBag.Title - @Model.SitesInfo.Title</title>
    <link href="/favicon.ico" rel="shortcut icon">
    <link href="/Content/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/Content/plugins/Slicebox/jquery.slicebox.css" rel="stylesheet">

    <link href="/Content/plugins/mobileGallery/swipebox.css" rel="stylesheet">
    <link href="/Content/css/common.css" rel="stylesheet" />
    <link href="~/Content/css/print.css" rel="stylesheet" type="text/css" media="print">

    <script src="/Content/plugins/jquery/jquery.js"></script>
    <script src="/Content/plugins/bootstrap/js/bootstrap.min.js"></script>
    <script src="/Content/plugins/jquery/jquery.ui.js"></script>
    <script src="/Content/plugins/jquery/jquery.mask.min.js"></script>
    <script src="/Content/plugins/Slicebox/modernizr.custom.46884.js"></script>
    <script src="/Content/plugins/Slicebox/jquery.slicebox.js"></script>
    <script src="/Content/plugins/mobileGallery/js/jquery.swipebox.js"></script>
    <script src="/Content/plugins/jquery/jquery.cookie.js"></script>
    <script src="/Content/js/script.js"></script>
    <script src='https://www.google.com/recaptcha/api.js'></script>
</head>

<body>
    <div class="mobile-indicator"></div>
    <div class="head_block">
        <div class="clouds">
            <div class="container">
                <div class="logo">
                    <a href="/"><img title="" alt="" src="~/Content/img/logo.png" /></a>

                    @if (Model != null && Model.SitesInfo != null && Model.SitesInfo.Phone != null)
                {
                    string MainPhone = (Model.SitesInfo.Phone.IndexOf("|") > -1) ? Model.SitesInfo.Phone.Substring(0, Model.SitesInfo.Phone.IndexOf("|")) : Model.SitesInfo.Phone;
                    MainPhone = MainPhone.Insert(MainPhone.LastIndexOf(" "), "<span>") + "</span>";

                        <div class="phone">@Html.Raw(MainPhone)</div>
                }
                </div>
                <div class="basket-block">
                    <a href="/basket">
                        <div class="basket-counter">
                            <div class="goods"><span>85</span> товаров</div>
                            <div class="price"><span>34285,75</span> руб.</div>
                        </div>
                        <img src="~/Content/img/basket.png" />
                    </a>
                </div>
                <div class="search-block">
                    <div>
                        <form id="search-form" action="/search/" method="post">
                            <input id="SearchText" class="search-text" placeholder="Поиск..." />
                            <button type="submit" class="button">Найти</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="menu_block">
        <div class="container">
            @if (mainMenu != null)
            {
            <ul class="nav navbar-nav navbar-left">
                @foreach (var item in mainMenu)
                {
                    string fullPath = "/";
                    if (!string.IsNullOrEmpty(item.Url))
                    {
                        fullPath = item.Url;
                    }
                    else if (item.FrontSection.ToLower().Equals("page"))
                    {
                        fullPath = item.Path + item.Alias;
                    }
                    else
                    {
                        fullPath = "/" + item.FrontSection;
                    }
                    string _class = (Request.Path == fullPath) ? "class=active" : "";
                    <li @_class>
                        <a href="@fullPath">@item.Title</a>
                    </li>
                    }
            </ul>
            }
            <div class="login-block">
                @if (Model.UserInfo == null)
                {
                    <a href="/user/login">Вход</a><a>/</a><a href="/user/reg">Регистрация</a>
                }
                else
                {
                    <a href="/user/">@Model.UserInfo.FIO</a><a>/</a><a href="/user/logout">Выход</a>
                }
            </div>
        </div>
    </div>
    <div class="body_block">
        <div class="container">
            <div class="row">
                <div class="col-md-4 col-lg-3">
                    <div class="prod-catalog">
                        <div class="title">Каталог</div>
                        @if (Model.ProdCatalog != null)
                        {
                            foreach (var item in Model.ProdCatalog)
                            {
                                <div class="catalog_item"><a href="/prod/?catalog=@item.Alias">@item.Title</a></div>
                            }
                        }
                    </div>
                    <div class="prod-new">
                        <a href=""><img src="~/Content/img/prod_new.jpg" /></a>
                    </div>
                </div>
                <div class="col-md-8 col-lg-9">
                    @RenderBody()
                </div>
            </div>
        </div>
    </div>
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-6 col-md-push-6">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="title">Контакты:</div>
                            <div>
                                <div class="telefon">тел.</div>
                                <div>@Html.Raw(Model.SitesInfo.Phone.Replace("|", "<br />"))</div>
                            </div>
                            <div>
                                <div class="email">e-mail</div>
                                <div>@Html.Raw(Model.SitesInfo.Email.Replace("|", "<br />"))</div>
                            </div>

                        </div>
                        <div class="col-md-6">
                            <div class="title">Режим работы</div>
                            @Html.Raw(Model.SitesInfo.Worktime.Replace("|", "<br />"))
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-md-pull-6">                    
                    <div class="adress"><b>@Model.SitesInfo.Adress</b>&nbsp;&nbsp;&nbsp;<a href="/contacts">Схема проезда</a></div>
                    <div class="socseti">
                        <a href="https://vk.com"><span class="icon-vkontakte"></span></a>
                        <a href="https://ru-ru.facebook.com/"><span class="icon-facebook"></span></a>
                        <a href="https://www.instagram.com/"><span class="icon-instagram"></span></a>
                    </div>
                    <div class="copyright">&copy;&nbsp;2010-@currentYear&nbsp;@Model.SitesInfo.LongTitle</div>
                    <div class="quote">@ViewBag.Quote</div>
                </div>
            </div>
        </div>
    </div>
    @Html.Raw(Model.SitesInfo.Scripts)

    @RenderSection("scripts", false)
</body>

</html>